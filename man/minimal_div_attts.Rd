% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/divide_atts_minimal.R
\name{minimal_div_attts}
\alias{minimal_div_attts}
\title{Compute minimal divide attributes from rasters and GW parquet}
\usage{
minimal_div_attts(
  gpkg,
  ISLTYP = "gridded/nwm/CONUS/ISLTYP.tif",
  IVGTYP = "gridded/nwm/CONUS/IVGTYP.tif",
  IMP = "gridded/nwm/CONUS/derived/CONUS_imp_240.tif",
  GW = "tabular/nwm_gw_basins.parquet"
)
}
\arguments{
\item{gpkg}{Character. Path to a GeoPackage containing \code{divides} and \code{network} layers.}

\item{ISLTYP}{Character. Path to a raster of soil type (ISLTYP).
Defaults to a CONUS path.}

\item{IVGTYP}{Character. Path to a raster of vegetation type (IVGTYP).
Defaults to a CONUS path.}

\item{IMP}{Character. Path to a raster for impervious fraction used for
zonal mean.}

\item{GW}{Character. Path to a parquet dataset with groundwater attributes,
expected to include columns \code{ComID} and \code{Zmax}.}
}
\value{
A tibble with one row per \code{divide_id} containing:
\itemize{
\item mode-based ISLTYP/IVGTYP attributes (column names as returned by \code{zonal}),
\item \code{IMP} zonal mean,
\item area-weighted mean \code{Zmax} (missing values imputed to 10).
}
}
\description{
Derives a minimal set of \strong{divide-level attributes} by running zonal
statistics on input rasters and area-weighting a groundwater (Zmax) field
from a parquet dataset, then joins results by \code{divide_id}.
}
\details{
It computes:
\itemize{
\item \strong{Mode ISLTYP/IVGTYP} per divide using \code{zonal::execute_zonal()} on the
provided rasters (via \code{terra::rast()}).
\item \strong{Mean impervious fraction} (\code{IMP}) per divide (zonal mean).
\item \strong{Area-weighted mean Zmax} per divide by joining GW parquet data
(\code{ComID}, \code{Zmax}) to the \code{network} layer on
\code{reference_id} = \code{ComID}, weighting by \code{incremental_areasqkm}.
}

The results are returned as a tibble.
}
\section{Requirements}{

\itemize{
\item The \code{divides} layer must contain \code{divide_id} and valid geometries.
\item The \code{network} layer must contain:
\code{divide_id}, \code{incremental_area_id}, \code{areasqkm},
\code{incremental_areasqkm}, and \code{reference_id}.
\item Rasters should be in a compatible projection or reprojectable by \code{terra}.
}
}

\section{Imputation}{

Any \code{Zmax} remaining \code{NA} after joins/weighting is imputed to \strong{10}.
}

\examples{
\dontrun{
out <- minimal_div_attts(
  gpkg   = "path/to/hydrofabric.gpkg",
  ISLTYP = "path/to/ISLTYP.tif",
  IVGTYP = "path/to/IVGTYP.tif",
  IMP    = "path/to/IMP.tif",
  GW     = "path/to/nwm_gw_basins.parquet"
)
dplyr::glimpse(out)
}
}
