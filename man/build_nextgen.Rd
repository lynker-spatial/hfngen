% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_nextgen.R
\name{build_nextgen}
\alias{build_nextgen}
\title{Build a NextGen-style network from a Hydrofabric GeoPackage}
\usage{
build_nextgen(
  flowpath_gpkg,
  flowline_gpkg = NULL,
  collapse_method = "upstream",
  nexus_prefix = "nex-",
  terminal_nexus_prefix = "tnx-",
  coastal_nexus_prefix = "cnx-",
  internal_nexus_prefix = "inx-",
  divide_prefix = "cat-",
  flowpath_prefix = "fp-",
  term_add = 1e+09,
  outfile = NULL
)
}
\arguments{
\item{flowpath_gpkg}{Character path to the \strong{flowpath/divide} Hydrofabric
GeoPackage. Must include at least layers \code{flowpaths} and \code{divides}.}

\item{flowline_gpkg}{Optional character path to a \strong{flowline-resolution}
Hydrofabric GeoPackage. If provided, \code{flowlines} and \code{incremental_areas}
tables are created and the \code{network} table is enriched with hydrolocation
attributes where available.}

\item{collapse_method}{Character, one of \code{"upstream"} (default) or
\code{"downstream"}. Controls which side receives the nexus identifier when
collapsing node-to-edge relationships.}

\item{nexus_prefix}{Character prefix for created nexus identifiers.}

\item{terminal_nexus_prefix}{Character prefix for created \strong{terminal} nexus
identifiers. (Reserved; currently all nexuses use \code{nexus_prefix}.)}

\item{coastal_nexus_prefix}{Character prefix for created \strong{coastal} nexus
identifiers. (Reserved.)}

\item{internal_nexus_prefix}{Character prefix for created \strong{internal} nexus
identifiers. (Reserved.)}

\item{divide_prefix}{Character prefix for divide (catchment) identifiers.}

\item{flowpath_prefix}{Character prefix for flowpath identifiers.}

\item{term_add}{Numeric scalar added to terminal \code{flowpath_toid} to create a
unique terminal-nexus keyspace (defaults to 1e9).}

\item{outfile}{Optional character file path (\*.gpkg). When provided, writes
all resulting layers to the specified GeoPackage; otherwise returns an R
list with the layers.}
}
\value{
Invisibly returns either the written \code{outfile} path (when \code{outfile}
is provided) or a named list with layers (\code{nexus}, \code{flowpaths}, \code{divides},
\code{flowlines}\emph{, \code{incremental_areas}}, \code{network}), where \code{*} indicates layers
present only when \code{flowline_gpkg} is supplied.
}
\description{
Translates a Hydrofabric flowpath/divide GeoPackage into a NextGen-style
topology with prefixed identifiers, optional flowline-level expansion, and an
integrated \code{network} table suitable for downstream modeling and ETL.
}
\examples{
\dontrun{
out <- build_nextgen(
  flowpath_gpkg = "hf_ref.gpkg",
  flowline_gpkg  = "hf_flowline.gpkg",
  outfile        = "nextgen.gpkg"
)
}

}
